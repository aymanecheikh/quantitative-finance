import requests
from requests.adapters import HTTPAdapter
from urllib3 import PoolManager
import ssl


BASE_URL = 'https://localhost:4002/v1/api'
HEADERS = {
    'Host': 'api.ibrkr.com',
    'User-Agent': 'Mozilla/5.0',
    'Accept': '*/*',
    'Connection': 'keep-alive'
}


class TLSAdapter(HTTPAdapter):
    def init_poolmanager(self, *args, **kwargs):
        context = ssl.create_default_context()
        context.minimum_version = ssl.TLSVersion.TLSv1_2
        kwargs['ssl_context'] = context
        return super().init_poolmanager(*args, **kwargs)


s = requests.Session()
s.mount('https://', TLSAdapter())

session_init = s.get(f'{BASE_URL}/portfolio/accounts',
    headers=HEADERS,
    verify=False
)
